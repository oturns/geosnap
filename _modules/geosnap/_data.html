<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>geosnap._data &#8212; geosnap v0.15.2 Manual</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=9afac83c" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <script src="../../_static/documentation_options.js?v=7c174e4c"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../_static/geosnap.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          geosnap</a>
        <span class="navbar-text navbar-version pull-left"><b>0.15.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../installation.html">Installation</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../data.html">Data</a></li>
                <li><a href="https://oturns.github.io/geosnap-guide/">User Guide</a></li>
                <li><a href="../../references.html">References</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installing-a-released-version">Installing a released version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installing-development-version">Installing development version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#io-module">IO Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#analyze-module">Analyze Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#harmonize-module">Harmonize Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#visualize-module">Visualize Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#util-module">Util Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#tabular-data">Tabular Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#geo-data">Geo Data</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for geosnap._data</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Tools for creating and manipulating neighborhood datasets.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">warnings</span><span class="w"> </span><span class="kn">import</span> <span class="n">warn</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">platformdirs</span><span class="w"> </span><span class="kn">import</span> <span class="n">user_data_dir</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_fetcher</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">warning_msg</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">warn</span><span class="p">(</span><span class="n">warning_msg</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">remote_path</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;anon&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">t</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_Map</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;tabbable dict.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Map</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Map</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Map</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>


<div class="viewcode-block" id="DataStore">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.html#geosnap.DataStore">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DataStore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Storage for geosnap data. Currently supports data from several U.S. federal agencies and national research centers.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataStore.__init__">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.html#geosnap.DataStore.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">disclaimer</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">appname</span> <span class="o">=</span> <span class="s2">&quot;geosnap&quot;</span>
        <span class="n">appauthor</span> <span class="o">=</span> <span class="s2">&quot;geosnap&quot;</span>

        <span class="k">if</span> <span class="n">data_dir</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">user_data_dir</span><span class="p">(</span><span class="n">appname</span><span class="p">,</span> <span class="n">appauthor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
        <span class="k">if</span> <span class="n">disclaimer</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The geosnap data storage class is provided for convenience only. The geosnap developers make no promises &quot;</span>
                <span class="s2">&quot;regarding data quality, consistency, or availability, nor are they responsible for any use/misuse of the data. &quot;</span>
                <span class="s2">&quot;The end-user is responsible for any and all analyses or applications created with the package.&quot;</span>
            <span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">atts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;acs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bea_regions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blocks_2000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blocks_2010&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blocks_2020&quot;</span><span class="p">,</span>
            <span class="s2">&quot;codebook&quot;</span><span class="p">,</span>
            <span class="s2">&quot;counties&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ejscreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ejscreen_codebook&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lodes_codebook&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ltdb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msa_definitions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msas&quot;</span><span class="p">,</span>
            <span class="s2">&quot;naics_definitions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ncdb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nces&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nlcd_definitions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;seda&quot;</span><span class="p">,</span>
            <span class="s2">&quot;states&quot;</span><span class="p">,</span>
            <span class="s2">&quot;show_data_dir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tracts_1990&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tracts_2000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tracts_2010&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tracts_2020&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">atts</span>

<div class="viewcode-block" id="DataStore.show_data_dir">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.show_data_dir.html#geosnap.DataStore.show_data_dir">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_data_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the location of the local geosnap data storage directory.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        string</span>
<span class="sd">            location of local storage directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span></div>


<div class="viewcode-block" id="DataStore.lodes_codebook">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.lodes_codebook.html#geosnap.DataStore.lodes_codebook">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">lodes_codebook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a table of descriptive variable names for the LODES data</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">            decription of variables returned with LODES/LEHD data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;io/lodes.csv&quot;</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataStore.bea_regions">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.bea_regions.html#geosnap.DataStore.bea_regions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">bea_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a table that maps states to their respective BEA regions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">            BEA region table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;io/bea_regions.csv&quot;</span>
            <span class="p">),</span>
            <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;stfips&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">},</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataStore.acs">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.acs.html#geosnap.DataStore.acs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">acs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="mi">2018</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;tract&quot;</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;American Community Survey Data (5-year estimates).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        year : str</span>
<span class="sd">            vingage of ACS release.</span>
<span class="sd">        level : str</span>
<span class="sd">            geographic level</span>
<span class="sd">        states : list, optional</span>
<span class="sd">            subset of states (as 2-digit fips) to return</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            geodataframe of ACS data indexed by FIPS code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;acs&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;acs_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://spatial-ucr/census/acs/acs_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">.parquet&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_acs()` to store the data locally for better performance&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;GEOID&quot;</span><span class="p">:</span> <span class="s2">&quot;geoid&quot;</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">geoid</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">states</span><span class="p">)]</span>
        <span class="n">t</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.seda">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.seda.html#geosnap.DataStore.seda">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">seda</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;school&quot;</span><span class="p">,</span> <span class="n">pooling</span><span class="o">=</span><span class="s2">&quot;pool&quot;</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="s2">&quot;gcs&quot;</span><span class="p">,</span> <span class="n">accept_eula</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Acheievement data from the Stanford Education Data Archive (currently version 4.1).</span>

<span class="sd">        May be joined with geodataframes from NCES for spatial analysis</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        level : str</span>
<span class="sd">            aggregation level for achievement data. Options include `school` for school-level,</span>
<span class="sd">            or `geodist` for geographic school district-level. By default &quot;school&quot;</span>
<span class="sd">        pooling : str</span>
<span class="sd">             option to return long-form or pooled data (&quot;pool&#39; or &#39;long&quot;). Only applicable for geodist level</span>
<span class="sd">            as long-form not available at the school level. By default &quot;pool&quot;</span>
<span class="sd">        standardize : str,</span>
<span class="sd">            which grouping method used to standardize the data. Options include</span>
<span class="sd">            &quot;gcs&quot; for grade-cohort standarization or &quot;cs&quot; for cohort standardization,</span>
<span class="sd">            by default &quot;gcs&quot;</span>
<span class="sd">        accept_eula : bool, optional</span>
<span class="sd">            pass True to accept the terms of the SEDA End User License Agreeement.</span>
<span class="sd">            The data and its agreement can be viewed at</span>
<span class="sd">            &lt;https://exhibits.stanford.edu/data/catalog/db586ns4974&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">eula</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">DATA USE AGREEMENT:</span>

<span class="s2">You agree not to use the data sets for commercial advantage, or in the course of for-profit activities. Commercial entities wishing to use this Service should contact Stanford University’s Office of Technology Licensing (info@otlmail.stanford.edu).</span>

<span class="s2">You agree that you will not use these data to identify or to otherwise infringe the privacy or confidentiality rights of individuals.</span>

<span class="s2">THE DATA SETS ARE PROVIDED “AS IS” AND STANFORD MAKES NO REPRESENTATIONS AND EXTENDS NO WARRANTIES OF ANY KIND, EXPRESS OR IMPLIED. STANFORD SHALL NOT BE LIABLE FOR ANY CLAIMS OR DAMAGES WITH RESPECT TO ANY LOSS OR OTHER CLAIM BY YOU OR ANY THIRD PARTY ON ACCOUNT OF, OR ARISING FROM THE USE OF THE DATA SETS.</span>

<span class="s2">You agree that this Agreement and any dispute arising under it is governed by the laws of the State of California of the United States of America, applicable to agreements negotiated, executed, and performed within California.</span>

<span class="s2">You agree to acknowledge the Stanford Education Data Archive as the source of these data. In publications, please cite the data as:</span>

<span class="s2">Reardon, S. F., Ho, A. D., Shear, B. R., Fahle, E. M., Kalogrides, D., Jang, H., &amp; Chavez, B. (2021). Stanford Education Data Archive (Version 4.1). Retrieved from http://purl.stanford.edu/db586ns4974.</span>

<span class="s2">Subject to your compliance with the terms and conditions set forth in this Agreement, Stanford grants you a revocable, non-exclusive, non-transferable right to access and make use of the Data Sets.</span>

<span class="s2">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">accept_eula</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;You must accept the EULA by passing `accept_eula=True` </span><span class="se">\n</span><span class="si">{</span><span class="n">eula</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;school&quot;</span><span class="p">,</span>
            <span class="s2">&quot;geodist&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Supported options for the `level` argument are &#39;school&#39; and &#39;geodist&#39;&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">pooling</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;pool&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">,</span>
            <span class="s2">&quot;poolsub&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`pool` argument must be either &#39;pool&#39;, &#39;long&#39;, or &#39;poolsub&#39;&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">standardize</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;gcs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cs&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`standardize` argument must be either &#39;cs&#39; for cohort-standardized or &#39;gcs&#39; for grade-cohort-standardized&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">pooling</span> <span class="o">==</span> <span class="s2">&quot;poolsub&quot;</span><span class="p">:</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;seda_</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">pooling</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">standardize</span><span class="si">}</span><span class="s2">_5.0&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;seda_</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">pooling</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">standardize</span><span class="si">}</span><span class="s2">_5.0&quot;</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="s2">&quot;geodist&quot;</span><span class="p">:</span>
            <span class="n">fn</span> <span class="o">+=</span> <span class="s2">&quot;_updated_20240319&quot;</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;seda&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fn</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://stacks.stanford.edu/file/druid:cs829jn7849/</span><span class="si">{</span><span class="n">fn</span><span class="si">}</span><span class="s2">.csv&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Streaming data from SEDA archive at &lt;https://exhibits.stanford.edu/data/catalog/db586ns4974&gt;.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Use `geosnap.io.store_seda()` to store the data locally for better performance&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="s2">&quot;school&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pooling</span> <span class="o">==</span> <span class="s2">&quot;pool&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The school level only supports pooled data&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="s2">&quot;school&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                        <span class="n">remote_path</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sedasch&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;fips&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
                    <span class="p">)</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">sedasch</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sedasch</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span><span class="p">(</span>
                        <span class="s2">&quot;Unable to access local or remote SEDA data&quot;</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="s2">&quot;geodist&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                        <span class="n">remote_path</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sedalea&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;fips&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
                    <span class="p">)</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">sedalea</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sedalea</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span><span class="p">(</span>
                        <span class="s2">&quot;Unable to access local or remote SEDA data&quot;</span>
                    <span class="p">)</span>
                <span class="n">t</span><span class="o">.</span><span class="n">fips</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.nces">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.nces.html#geosnap.DataStore.nces">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">nces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="mi">1516</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;sabs&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;National Center for Education Statistics (NCES) Data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        year : str</span>
<span class="sd">            vintage of NCES release formatted as a 4-character string representing</span>
<span class="sd">            the school year. For example the 2015-2016 academic year is &#39;1516&#39;</span>
<span class="sd">        dataset : str</span>
<span class="sd">            which dataset to query. Options include `sabs`, `school_districts`, and `schools`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            geodataframe of NCES data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selector</span> <span class="o">=</span> <span class="s2">&quot;districts&quot;</span> <span class="k">if</span> <span class="n">dataset</span> <span class="o">==</span> <span class="s2">&quot;school_districts&quot;</span> <span class="k">else</span> <span class="n">dataset</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;nces&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://spatial-ucr/nces/</span><span class="si">{</span><span class="n">selector</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.parquet&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_nces()` to store the data locally for better performance&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="c1"># t = t.reset_index().rename(columns={&quot;GEOID&quot;: &quot;geoid&quot;})</span>

        <span class="n">t</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.ejscreen">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.ejscreen.html#geosnap.DataStore.ejscreen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ejscreen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="mi">2018</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;EPA EJScreen Data &lt;https://www.epa.gov/ejscreen&gt;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        year : str</span>
<span class="sd">            vingage of EJSCREEN release.</span>
<span class="sd">        states : list, optional</span>
<span class="sd">            subset of states (as 2-digit fips) to return</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            geodataframe of EJSCREEN data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;epa&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ejscreen_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://spatial-ucr/epa/ejscreen/ejscreen_</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.parquet&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_ejscreen()` to store the data locally for better performance&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="s2">&quot;geoid&quot;</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">geoid</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">states</span><span class="p">)]</span>
        <span class="n">t</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.ejscreen_codebook">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.ejscreen_codebook.html#geosnap.DataStore.ejscreen_codebook">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ejscreen_codebook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Table of variable definitions used in the EPE Environmental Justice Screening dataset</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">            table that stores variable names and definitions.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;io/ejscreen_codebook.csv&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataStore.blocks_2000">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.blocks_2000.html#geosnap.DataStore.blocks_2000">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">blocks_2000</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fips</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Census blocks for 2000.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list-like</span>
<span class="sd">            list of state fips codes to return as a datafrrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">        pandas.DataFrame or geopandas.GeoDataFrame</span>
<span class="sd">            2000 blocks as a geodataframe or as a dataframe with geometry</span>
<span class="sd">            stored as well-known binary on the &#39;wkb&#39; column.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Unable to locate local census 2010 block data. Streaming instead.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;If you plan to use census data repeatedly you can store it locally &quot;</span>
            <span class="s2">&quot;with the io.store_blocks_2010 function for better performance&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="n">states</span><span class="p">]</span>
        <span class="n">blks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;blocks_2000&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>
            <span class="n">remote</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://spatial-ucr/census/blocks_2000/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">.parquet&quot;</span>
            <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fips</span><span class="p">:</span>
                <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;geoid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">fips</span><span class="p">)]</span>

            <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">blks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">blocks</span></div>


<div class="viewcode-block" id="DataStore.blocks_2010">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.blocks_2010.html#geosnap.DataStore.blocks_2010">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">blocks_2010</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fips</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Census blocks for 2010.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list-like</span>
<span class="sd">            list of state fips codes to return as a datafrrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">        pandas.DataFrame or geopandas.GeoDataFrame</span>
<span class="sd">            2010 blocks as a geodataframe or as a dataframe with geometry</span>
<span class="sd">            stored as well-known binary on the &#39;wkb&#39; column.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Unable to locate local census 2010 block data. Streaming instead.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;If you plan to use census data repeatedly you can store it locally &quot;</span>
            <span class="s2">&quot;with the io.store_blocks_2010 function for better performance&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="n">states</span><span class="p">]</span>
        <span class="n">blks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;blocks_2010&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>
            <span class="n">remote</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://spatial-ucr/census/blocks_2010/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">.parquet&quot;</span>
            <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fips</span><span class="p">:</span>
                <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;geoid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">fips</span><span class="p">)]</span>

            <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2010</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">blks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">blocks</span></div>


<div class="viewcode-block" id="DataStore.blocks_2020">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.blocks_2020.html#geosnap.DataStore.blocks_2020">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">blocks_2020</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fips</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Census blocks for 2020.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list-like</span>
<span class="sd">            list of state fips codes to return as a datafrrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">        pandas.DataFrame or geopandas.GeoDataFrame</span>
<span class="sd">            2010 blocks as a geodataframe or as a dataframe with geometry</span>
<span class="sd">            stored as well-known binary on the &#39;wkb&#39; column.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Unable to locate local census 2020 block data. Streaming instead.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;If you plan to use census data repeatedly you can store it locally &quot;</span>
            <span class="s2">&quot;with the io.store_blocks_2020 function for better performance&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="n">states</span><span class="p">]</span>
        <span class="n">blks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;blocks_2020&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span>
            <span class="n">remote</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://spatial-ucr/census/blocks_2020/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">.parquet&quot;</span>
            <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fips</span><span class="p">:</span>
                <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;geoid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">fips</span><span class="p">)]</span>

            <span class="n">blks</span><span class="p">[</span><span class="n">state</span><span class="p">][</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2020</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">blks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">blocks</span></div>


<div class="viewcode-block" id="DataStore.tracts_1990">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.tracts_1990.html#geosnap.DataStore.tracts_1990">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tracts_1990</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nationwide Census Tracts as drawn in 1990 (cartographic 500k).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list-like</span>
<span class="sd">            list of state fips to subset the national dataframe</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame or geopandas.GeoDataFrame</span>
<span class="sd">            1990 tracts as a geodataframe or as a dataframe with geometry</span>
<span class="sd">            stored as well-known binary on the &#39;wkb&#39; column.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_census() to store the data locally for better performance&quot;</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;tracts_1990_500k.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote</span> <span class="o">=</span> <span class="s2">&quot;s3://spatial-ucr/census/tracts_cartographic/tracts_1990_500k.parquet&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">geoid</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">states</span><span class="p">)]</span>
        <span class="n">t</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1990</span>

        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.tracts_2000">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.tracts_2000.html#geosnap.DataStore.tracts_2000">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tracts_2000</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nationwide Census Tracts as drawn in 2000 (cartographic 500k).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list-like</span>
<span class="sd">            list of state fips to subset the national dataframe</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            2000 tracts as a geodataframe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;tracts_2000_500k.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote</span> <span class="o">=</span> <span class="s2">&quot;s3://spatial-ucr/census/tracts_cartographic/tracts_2000_500k.parquet&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_census() to store the data locally for better performance&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">geoid</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">states</span><span class="p">)]</span>
        <span class="n">t</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>

        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.tracts_2010">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.tracts_2010.html#geosnap.DataStore.tracts_2010">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tracts_2010</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nationwide Census Tracts as drawn in 2010 (cartographic 500k).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list-like</span>
<span class="sd">            list of state fips to subset the national dataframe</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            2010 tracts as a geodataframe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_census() to store the data locally for better performance&quot;</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;tracts_2010_500k.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote</span> <span class="o">=</span> <span class="s2">&quot;s3://spatial-ucr/census/tracts_cartographic/tracts_2010_500k.parquet&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">geoid</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">states</span><span class="p">)]</span>
        <span class="n">t</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2010</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.tracts_2020">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.tracts_2020.html#geosnap.DataStore.tracts_2020">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tracts_2020</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nationwide Census Tracts as drawn in 2020 (cartographic 500k).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list-like</span>
<span class="sd">            list of state fips to subset the national dataframe</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            2020 tracts as a geodataframe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_census() to store the data locally for better performance&quot;</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;tracts_2020_500k.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote</span> <span class="o">=</span> <span class="s2">&quot;s3://spatial-ucr/census/tracts_cartographic/tracts_2020_500k.parquet&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">geoid</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">states</span><span class="p">)]</span>
        <span class="n">t</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2020</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.msas">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.msas.html#geosnap.DataStore.msas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">msas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Metropolitan Statistical Areas as drawn in 2020.</span>

<span class="sd">        Data come from the U.S. Census Bureau&#39;s most recent TIGER/LINE files</span>
<span class="sd">        https://www.census.gov/cgi-bin/geo/shapefiles/index.php?year=2020&amp;layergroup=Core+Based+Statistical+Areas</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            2010 MSAs as a geodataframe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;msas.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote</span> <span class="o">=</span> <span class="s2">&quot;s3://spatial-ucr/census/administrative/msas.parquet&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_census() to store the data locally for better performance&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.states">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.states.html#geosnap.DataStore.states">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;States.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            US States as a geodataframe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;states.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote</span> <span class="o">=</span> <span class="s2">&quot;s3://spatial-ucr/census/administrative/states.parquet&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_census() to store the data locally for better performance&quot;</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.counties">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.counties.html#geosnap.DataStore.counties">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">counties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nationwide counties as drawn in 2010.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            2010 counties as a geodataframe.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;counties.parquet&quot;</span><span class="p">)</span>
        <span class="n">remote</span> <span class="o">=</span> <span class="s2">&quot;s3://spatial-ucr/census/administrative/counties.parquet&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Streaming data from S3. Use `geosnap.io.store_census() to store the data locally for better performance&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">_fetcher</span><span class="p">(</span><span class="n">local</span><span class="p">,</span> <span class="n">remote</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="DataStore.msa_definitions">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.msa_definitions.html#geosnap.DataStore.msa_definitions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">msa_definitions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;2010 Metropolitan Statistical Area definitions.</span>

<span class="sd">        Data come from the U.S. Census Bureau&#39;s most recent delineation files, available at</span>
<span class="sd">        https://www.census.gov/geographies/reference-files/time-series/demo/metro-micro/delineation-files.html</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame.</span>
<span class="sd">            dataframe that stores state/county --&gt; MSA crosswalk definitions.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;io/msa_definitions.csv&quot;</span>
            <span class="p">),</span>
            <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;stcofips&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">},</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataStore.ltdb">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.ltdb.html#geosnap.DataStore.ltdb">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ltdb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Longitudinal Tract Database (LTDB).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame or geopandas.GeoDataFrame</span>
<span class="sd">            LTDB as a long-form geo/dataframe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;ltdb.parquet&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Unable to locate LTDB data. Try saving the data again &quot;</span>
                <span class="s2">&quot;using the `store_ltdb` function&quot;</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="DataStore.ncdb">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.ncdb.html#geosnap.DataStore.ncdb">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ncdb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Geolytics Neighborhood Change Database (NCDB).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrarme</span>
<span class="sd">            NCDB as a long-form dataframe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;ncdb.parquet&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Unable to locate NCDB data. Try saving the data again &quot;</span>
                <span class="s2">&quot;using the `store_ncdb` function&quot;</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="DataStore.codebook">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.codebook.html#geosnap.DataStore.codebook">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">codebook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Codebook.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">            codebook that stores variable names, definitions, and formulas.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;io/variables.csv&quot;</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataStore.nlcd_definitions">
<a class="viewcode-back" href="../../generated/geosnap.DataStore.nlcd_definitions.html#geosnap.DataStore.nlcd_definitions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">nlcd_definitions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Table of NLCD land classification system definitions.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">            table that stores variable names, definitions, and formulas.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;io/nlcd_definitions.csv&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span></div>
</div>

</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2023, geosnap developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>